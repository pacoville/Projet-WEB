<?php
session_start();

if ($_SERVER["REQUEST_METHOD"] == "POST") {
    // Variables de connexion à la base de données
    $servername = "localhost";
    $username = "root";
    $password = "";
    $dbname = "piscine";

    // Connexion à la base de données
    try {
        $dbh = new PDO("mysql:host=$servername;dbname=$dbname", $username, $password);
        // Configuration du mode d'erreur PDO pour afficher les erreurs
        $dbh->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
    } catch (PDOException $e) {
        die('Erreur de connexion à la base de données : ' . $e->getMessage());
    }

    // Récupération des données du formulaire
    $email = $_POST["email"];
    $password = $_POST["password"];

    // Préparation et exécution de la requête SQL pour récupérer l'utilisateur
    $requete = $dbh->prepare("SELECT * FROM utilisateur WHERE email = ?");
    $requete->bindParam(1, $email, PDO::PARAM_STR);
    $requete->execute();

    // Récupération de l'utilisateur depuis la base de données
    $user = $requete->fetch(PDO::FETCH_ASSOC);

    // Vérification du mot de passe
    if ($user && password_verify($password, $user['mdp_hash'])) {
        // Enregistrement des informations de l'utilisateur dans la session
        $_SESSION['utilisateur_id'] = $user['utilisateur_id'];
        $_SESSION['user_nom'] = $user['nom'];
        $_SESSION['user_prenom'] = $user['prenom'];
        $_SESSION['user_email'] = $user['email'];
        $_SESSION['user_adresse'] = $user['adresse'];

        // Redirection vers la page d'accueil
        header("Location: compte-client.php");
        exit(); // Assurez-vous de terminer le script après la redirection
    } else {
        // Identifiants incorrects
        echo "Identifiants incorrects.";
    }
}
?>
<html>
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="style.css">
    <title>compte coach</title>
    <link href="logo.jpg" rel="icon" type="image/x-icon" />
    <script src="script.js" defer></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <!-- Bibliothèque jQuery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>
    <!-- Dernier JavaScript compilé -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    <style>
        .nav-item {
            position: relative; /* Ajouté pour permettre le positionnement absolu du menu déroulant */
            border: 1.5px solid black;
            background-color: black;
            padding: 10px;
            margin: auto;
            color: #FE7000;
            text-align: center;
            border-radius: 10px;
            height: 75px;
        }

        .dropdown-menu {
            display: none;
            position: absolute;
            top: -175%; /* Positionné juste en dessous de l'élément parent */
            left: -1%; /* Positionné au milieu horizontalement */
            transform: translateX(0%); /* Centré horizontalement */
            background-color: #333; /* Mise à jour de la couleur de fond */
            box-shadow: 0 8px 16px rgba(0,0,0,0.2);
            z-index: 1;
        }

        .card {
            height: auto;
        }

         #navigation {
            position: fixed;
            bottom: 79px; /* Vous pouvez ajuster cette valeur selon vos besoins */
            width: 100%;
            /*désirée */
            z-index: 1000;
        }

        #footer {
            display: flex;
            align-items: center;
            justify-content: center;  
            color: #FE7000;
            font-size: 0.60em;  
            font-style: italic; 
            background: url("backgroundee.jpg");
            height: 79px;
            position: fixed;
            bottom: 0;
            width: 100%;
            padding: 10px 0;
            z-index: 1000;
        }

        #footer table {
            text-align: center;
        }

        #footer p, #footer a {
            margin: 0;
            color: #FE7000;
            text-decoration: none;
        }

        #footer a:hover {
            text-decoration: underline; /* Optionnel : ajoute un soulignement au survol */
        }
    </style>
</head>
